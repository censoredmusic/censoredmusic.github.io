<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harris Academy Morden</title>
<link rel="icon" type="image/png" href="covers/icon.png">
<style>
:root {
  --accent-color: #1db954;
  --bg-image: url('covers/daylight.jpg');
}
body {
  margin:0; font-family: Arial, Helvetica, sans-serif;
  background:#000; color:white;
  display:flex; justify-content:center; align-items:center;
  min-height:100vh; transition:background 0.5s;
}
body::before {
  content:""; position:fixed; inset:0;
  background-image: var(--bg-image);
  background-size:cover; background-position:center;
  filter: blur(40px) brightness(0.5);
  z-index:-1; transition:0.5s;
}
.player {
  width:350px; height:600px; background:#181818;
  border-radius:16px; padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,0.5);
  display:flex; flex-direction:column; justify-content:space-between;
  transition:all 0.3s;
}
.title { text-align:center; font-size:1.4rem; margin-bottom:10px; }
.cover { width:100%; height:300px; background-size:cover; background-position:center; border-radius:12px; margin-bottom:10px; flex-shrink:0; }
.song-name { text-align:center; font-size:1.1rem; margin-bottom:10px; flex-shrink:0; }
.controls { display:flex; justify-content:space-between; align-items:center; margin:10px 0; flex-shrink:0; }
button { background:var(--accent-color); border:none; color:black; padding:10px 15px; border-radius:50px; font-weight:bold; cursor:pointer; transition:0.2s; }
button:hover { opacity:0.85; }
.lyrics { flex:1; overflow-y:auto; background:#101010; padding:10px; border-radius:10px; font-size:0.9rem; line-height:1.4; margin-bottom:10px; }
.lyrics span { color:#888; display:block; padding:5px; cursor:pointer; }
.lyrics span.active { color: var(--accent-color); font-weight:bold; }
.lyrics span.dragging { opacity:0.5; }
.nav-buttons { display:flex; justify-content:space-around; margin-top:5px; flex-shrink:0; }

/* Mini Floating Bar */
.mini-bar {
  position: fixed; bottom:0; left:50%; transform:translateX(-50%);
  width:350px; border-radius:16px 16px 0 0; padding:10px;
  display:flex; align-items:center; justify-content:space-between;
  box-shadow:0 -5px 15px rgba(0,0,0,0.5);
  backdrop-filter: blur(20px) saturate(180%);
  background: rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.2);
  opacity:0; pointer-events:none;
  transition: opacity 0.5s;
}
.mini-bar.visible { opacity:1; pointer-events:auto; animation: fadeIn 0.6s ease; }
@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }

.mini-cover { width:50px; height:50px; background-size:cover; border-radius:10px; margin-right:10px; flex-shrink:0; }
.mini-info { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.mini-info span { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.mini-controls button { padding:5px 10px; }
.progress-bar { width:100%; height:5px; background:#333; border-radius:5px; margin-top:2px; }
.progress-fill { height:100%; background:var(--accent-color); border-radius:5px; width:0%; }

.search-input { width:100%; padding:8px; border-radius:10px; border:none; margin-bottom:10px; font-size:1rem; }

/* Secret screen styles */
.secret-screen {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:100%; width:100%; text-align:center;
}
.secret-screen div { margin:5px 0; font-size:1.2rem; }
.secret-code { font-size:1.5rem; letter-spacing:5px; margin-bottom:20px; }
.keypad {
  display:grid; grid-template-columns:repeat(3, 60px); gap:15px;
}
.keypad button {
  width:60px; height:60px; border-radius:50%; font-size:1.2rem;
  background:#333; color:white; border:none; cursor:pointer;
  display:flex; justify-content:center; align-items:center;
  transition:0.2s;
}
.keypad button:hover { background:var(--accent-color); color:black; }
</style>
</head>
<body>

<div class="player" id="player">
  <div class="title" id="pageTitle">ü§¨ Censored Music</div>
  <div id="cover" class="cover"></div>
  <div id="songName" class="song-name"></div>

  <div class="controls" id="songControls">
    <button onclick="prevSong()">‚èÆ Back</button>
    <button onclick="togglePlay()">‚ñ∂ / ‚è∏</button>
    <button onclick="nextSong()">Next ‚è≠</button>
  </div>

  <div id="lyrics" class="lyrics"></div>

  <div class="nav-buttons">
    <button onclick="switchPage('home')">üèùÔ∏è Home</button>
    <button onclick="switchPage('album')">üíø Playlist</button>
    <button onclick="switchPage('queue')">üéµ Queue</button>
    <button onclick="switchPage('search')">üîç Search</button>
  </div>
</div>

<!-- Mini Floating Bar -->
<div class="mini-bar" id="miniBar">
  <div class="mini-cover" id="miniCover"></div>
  <div class="mini-info">
    <span id="miniSongName"></span>
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
  </div>
  <div class="mini-controls">
    <button onclick="togglePlay()">‚ñ∂ / ‚è∏</button>
  </div>
</div>

<audio id="audio"></audio>

<script>
// Songs and Multiple Playlists
const playlists = {
  "Raghib's Playlist": [
    {name:"Daylight (Drake)",src:"music/daylight_drake.mp3",cover:"covers/daylight.jpg",lyrics:[{time:0,text:"Treat all my exes like Jehovah's Witnesses"},{time:4,text:"Free all the dogs and fuck all the witnesses"}]},
    {name:"Parade on Cleveland (Young Thug ft. Drake)",src:"music/parade_on_cleveland.mp3",cover:"covers/parade.jpg",lyrics:[{time:0,text:"Whoa"},{time:3,text:"How the fuck you out here goin' tit-for-tat?"}]}
  ],
  "Chill Vibes": [
    {name:"Song A",src:"music/songA.mp3",cover:"covers/songA.jpg",lyrics:[]},
    {name:"Song B",src:"music/songB.mp3",cover:"covers/songB.jpg",lyrics:[]}
  ]
};

// Default songs array for Home / Queue
let songs = playlists["Raghib's Playlist"];
let currentSong=0;
let currentPage='home';

const audio=document.getElementById("audio");
const cover=document.getElementById("cover");
const songName=document.getElementById("songName");
const lyricsDiv=document.getElementById("lyrics");
const pageTitle=document.getElementById("pageTitle");
const songControls=document.getElementById("songControls");
const miniBar=document.getElementById("miniBar");
const miniCover=document.getElementById("miniCover");
const miniSongName=document.getElementById("miniSongName");
const progressFill=document.getElementById("progressFill");

// Load a song
function loadSong(index){
  const song=songs[index];
  audio.src=song.src;
  cover.style.backgroundImage=`url('${song.cover}')`;
  songName.textContent=song.name;
  miniCover.style.backgroundImage=`url('${song.cover}')`;
  miniSongName.textContent=song.name;
  document.body.style.setProperty("--bg-image",`url('${song.cover}')`);
  extractAccentColor(song.cover);

  if(currentPage==='home'){
    lyricsDiv.innerHTML="";
    song.lyrics.forEach(line=>{
      const span=document.createElement("span");
      span.textContent=line.text;
      span.dataset.time=line.time;
      lyricsDiv.appendChild(span);
    });
  }
}

// Play / Pause
function togglePlay(){if(audio.paused)audio.play();else audio.pause();}
function nextSong(){currentSong=(currentSong+1)%songs.length;loadSong(currentSong);audio.play();}
function prevSong(){currentSong=(currentSong-1+songs.length)%songs.length;loadSong(currentSong);audio.play();}

// Progress bar & lyrics highlighting
audio.addEventListener("timeupdate",()=>{
  const currentTime=audio.currentTime;
  const lines=lyricsDiv.querySelectorAll("span");
  lines.forEach(line=>{
    const time=Number(line.dataset.time);
    if(currentTime>=time){lines.forEach(l=>l.classList.remove("active"));line.classList.add("active");}
  });
  const progress=(audio.currentTime/audio.duration)*100;
  progressFill.style.width=isNaN(progress)?'0%':progress+'%';
});

// Accent color extraction
function extractAccentColor(imageSrc){
  const img=new Image(); img.crossOrigin="anonymous"; img.src=imageSrc;
  img.onload=()=>{
    const canvas=document.createElement("canvas");
    const ctx=canvas.getContext("2d");
    canvas.width=img.width;canvas.height=img.height;
    ctx.drawImage(img,0,0);
    const data=ctx.getImageData(0,0,canvas.width,canvas.height).data;
    let r=0,g=0,b=0,count=0;
    for(let i=0;i<data.length;i+=40){r+=data[i];g+=data[i+1];b+=data[i+2];count++;}
    r=Math.floor(r/count);g=Math.floor(g/count);b=Math.floor(b/count);
    document.documentElement.style.setProperty("--accent-color",`rgb(${r},${g},${b})`);
  };
}

// Drag & Drop Queue
let dragSrcIndex=null;
function handleDragStart(e){ dragSrcIndex=Number(this.dataset.index); this.classList.add('dragging'); }
function handleDragOver(e){ e.preventDefault(); }
function handleDrop(e){ e.stopPropagation(); const targetIndex=Number(this.dataset.index); if(dragSrcIndex===null||dragSrcIndex===targetIndex) return; const moved=songs.splice(dragSrcIndex,1)[0]; songs.splice(targetIndex,0,moved); renderQueue(); }
function handleDragEnd(){ this.classList.remove('dragging'); }

function renderQueue(){
  lyricsDiv.innerHTML="";
  songs.forEach((s,i)=>{
    const span=document.createElement("span");
    span.textContent=(i===currentSong?'‚û° ':'')+s.name;
    span.dataset.index=i;
    span.draggable=true;
    span.addEventListener('dragstart', handleDragStart);
    span.addEventListener('dragover', handleDragOver);
    span.addEventListener('drop', handleDrop);
    span.addEventListener('dragend', handleDragEnd);
    lyricsDiv.appendChild(span);
  });
}

// Playlist Handling
function showPlaylists(){
  lyricsDiv.innerHTML="";
  Object.keys(playlists).forEach(plistName=>{
    const span=document.createElement("span");
    span.textContent=plistName;
    span.style.cursor='pointer';
    span.onclick=()=>showPlaylistSongs(plistName);
    lyricsDiv.appendChild(span);
  });
}

function showPlaylistSongs(plistName){
  songs=playlists[plistName]; // change current song array
  currentSong=0;
  lyricsDiv.innerHTML="";
  songs.forEach((song,i)=>{
    const span=document.createElement("span");
    span.textContent=song.name;
    span.style.cursor='pointer';
    span.onclick=()=>{loadSong(i);audio.play(); switchPage('home');};
    lyricsDiv.appendChild(span);
  });
}

// Page Switching
function switchPage(page){
  currentPage=page;

  if(page==='home'){
    pageTitle.textContent="ü§¨ Censored Music";
    cover.style.display="block"; songName.style.display="block"; songControls.style.display="flex"; 
    loadSong(currentSong);
    miniBar.classList.remove('visible');
  } else if(page==='album'){
    pageTitle.textContent="üíø Playlist";
    cover.style.display="block"; songName.style.display="block"; songControls.style.display="none"; 
    showPlaylists();
    lyricsDiv.style.display="block";
    miniBar.classList.add('visible');
  } else if(page==='queue'){
    pageTitle.textContent="üéµ Queue Page";
    cover.style.display="none"; songName.style.display="none"; songControls.style.display="none";
    renderQueue(); lyricsDiv.style.display="block";
    miniBar.classList.add('visible');
  } else if(page==='search'){
    pageTitle.textContent="üîç Search";
    cover.style.display="none"; songName.style.display="none"; songControls.style.display="none";
    lyricsDiv.innerHTML=`<input class="search-input" id="searchInput" placeholder="Search songs..." oninput="filterSongs()"><div id="searchResults"></div>`;
    document.getElementById("searchResults").innerHTML=songs.map((s,i)=>`<span onclick="playFromSearch(${i})">${s.name}</span>`).join("");
    lyricsDiv.style.display="block";
    miniBar.classList.add('visible');
  }
}

function filterSongs(){
  const query=document.getElementById("searchInput").value.toLowerCase();
  const resultsDiv=document.getElementById("searchResults");
  resultsDiv.innerHTML=songs.map((s,i)=>s.name.toLowerCase().includes(query)?`<span onclick="playFromSearch(${i})">${s.name}</span>`:'').join('');
}

function playFromSearch(index){currentSong=index;loadSong(currentSong);audio.play();switchPage('home');}

// ---- SECRET CODE FEATURE ----
let secretActive=false;
let typed="";
const code="150677";
let buffer="";

document.addEventListener("keydown", e=>{
  buffer+=e.key.toLowerCase();
  if(buffer.endsWith("secret")){
    toggleSecret();
    buffer="";
  }
});

function toggleSecret(){
  secretActive=!secretActive;
  if(secretActive){
    player.innerHTML=`
      <div class="secret-screen">
        <div>Enter Code</div>
        <div class="secret-code" id="secretCode"></div>
        <div class="keypad" id="keypad">
          ${[1,2,3,4,5,6,7,8,9,'',0,''].map(n=>`<button onclick="pressKey('${n}')">${n}</button>`).join('')}
        </div>
      </div>`;
  } else location.reload();
}

function pressKey(n){
  if(n==='') return;
  typed+=n;
  updateSecret();
}

function updateSecret(){
  const el=document.getElementById("secretCode");
  el.textContent="‚Ä¢".repeat(typed.length);
  if(typed===code) el.textContent="‚úÖ UNLOCKED";
  if(typed.length>code.length) typed="";
}

// ---- END SECRET FEATURE ----

// Init
loadSong(currentSong);
switchPage('home');
</script>
</body>
</html>

